#! /usr/bin/bash
source checkName
create_table() {
   
    DBName="$1"
   # tables=$(find Database/$DBName -type f)
    tables=$( ls Database/$DBName | grep -v "_metaData")
    for file in $tables;do
    echo $file
    done
    modifiedTableName=$(check_name $TableName)
    echo $modifiedTableName
    while true; do
            read -p "Enter the name of the table: " TableName
            if [[ $modifiedTableName != 1 ]]; then
                if [[ ! -e Database/$DBName/$modifiedTableName ]]; then
                    touch "Database/$DBName/$modifiedTableName"
                    touch "Database/$DBName/${$modifiedTableName}_metaData"
                    break
                else
                    echo the table already exist
                fi
            else
              echo "Invalid table name."
           fi
    done

    read -p "Enter the number of fields: " NumFields

     for ((i = 1; i <= NumFields; i++)); do
        read -p "Enter the name of field $i: " FieldName
        printf "$FieldName:" >> "Database/$DBName/${TableName}_metaData"

        read -p "Enter the datatype of field $i (string/int): " DataType
        printf "$DataType:" >> "Database/$DBName/${TableName}_metaData"

        read -p "Is field $i a primary key? (y/n): " IsPrimaryKey
        if [ "$IsPrimaryKey" == "y" ]; then
           printf "pk \n">> "Database/$DBName/${TableName}_metaData"
        #else 
          # printf "\n"
        fi     

    done

    echo "Table $TableName created successfully in $DBName database."
}
list_tables() {
  DBName="$1"
  ls Database/$DBName | grep -v "_metaData"
} 
drop_table(){
    DBName="$1"
    read -p "Enter the name of the table: " TableName
    tables=$( ls Database/$DBName | grep -v "_metaData")
    for file in $tables;do
        if [ "$TableName" == "$file" ];then
            rm Database/$DBName/$TableName 
            rm "Database/$DBName/${TableName}_metaData"
            echo "Table $TableName droped successfully in $DBName database."
            break
        else
        echo "Table $TableName not exist"
        break
        fi
    done
}
#create_table "MyDatabase"
#list_tables "MyDatabase"
#drop_tables "MyDatabase"

